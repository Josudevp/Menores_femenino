<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Torneo de Voleibol</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Chosen Palette: Slate & Sky Blue -->
    <style>
        body {
            background-color: #f8fafc; 
        }
        .nav-link.active {
            background-color: #0284c7;
            color: white;
        }
        .group-filter.active {
            background-color: #0369a1;
            color: white;
            border-color: #0369a1;
        }
        .bracket-item {
            border: 2px solid #e2e8f0;
        }
        .bracket-path {
            position: relative;
            width: 100%;
        }
        .bracket-path::before {
            content: '';
            position: absolute;
            top: 50%;
            left: -1rem;
            width: 1rem;
            height: 2px;
            background-color: #94a3b8;
        }
        .bracket-round {
            display: flex;
            flex-direction: column;
            justify-content: space-around;
        }
        .score-input {
            -moz-appearance: textfield;
        }
        .score-input::-webkit-outer-spin-button,
        .score-input::-webkit-inner-spin-button {
            -webkit-appearance: none;
            margin: 0;
        }
    </style>
</head>
<body class="font-sans antialiased text-slate-800">

    <header class="bg-white shadow-md sticky top-0 z-10">
        <nav class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex items-center justify-between h-16">
                <h1 class="text-2xl font-bold text-sky-700">Torneo de Voleibol</h1>
                <div class="hidden sm:block">
                    <div class="flex items-baseline space-x-4">
                        <a href="#grupos" class="nav-link px-3 py-2 rounded-md text-sm font-medium text-slate-700 hover:bg-sky-100 active">Grupos</a>
                        <a href="#fase-grupos" class="nav-link px-3 py-2 rounded-md text-sm font-medium text-slate-700 hover:bg-sky-100">Fase de Grupos</a>
                        <a href="#intergrupos" class="nav-link px-3 py-2 rounded-md text-sm font-medium text-slate-700 hover:bg-sky-100">Intergrupos</a>
                        <a href="#ranking-general" class="nav-link px-3 py-2 rounded-md text-sm font-medium text-slate-700 hover:bg-sky-100">Ranking General</a>
                        <a href="#fase-final" class="nav-link px-3 py-2 rounded-md text-sm font-medium text-slate-700 hover:bg-sky-100">Fase Final</a>
                    </div>
                </div>
                 <div class="sm:hidden">
                    <select id="mobile-nav" class="block w-full pl-3 pr-10 py-2 text-base border-gray-300 focus:outline-none focus:ring-sky-500 focus:border-sky-500 sm:text-sm rounded-md">
                        <option value="#grupos">Grupos</option>
                        <option value="#fase-grupos">Fase de Grupos</option>
                        <option value="#intergrupos">Intergrupos</option>
                        <option value="#ranking-general">Ranking General</option>
                        <option value="#fase-final">Fase Final</option>
                    </select>
                </div>
            </div>
        </nav>
    </header>

    <main class="max-w-7xl mx-auto py-6 sm:px-6 lg:px-8">
        
        <section id="grupos" class="page-section">
            <div class="px-4 py-6 sm:px-0">
                <h2 class="text-3xl font-bold tracking-tight text-slate-900 mb-6">Composición de Grupos y Posiciones</h2>
                <p class="text-slate-600 mb-8 max-w-3xl">Aquí se muestra la distribución de los equipos. Las tablas de posiciones se actualizan automáticamente al ingresar los resultados en la sección "Fase de Grupos" y "Intergrupos". El sistema de puntuación es: 2 puntos por partido ganado y 1 punto por partido perdido.</p>
                <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
                    
                    <div id="group-card-A" class="bg-white p-6 rounded-lg shadow-lg">
                        <h3 class="text-xl font-bold text-sky-700 mb-4">Grupo A</h3>
                        <div class="overflow-x-auto">
                            <table class="w-full text-sm text-left text-slate-500">
                                <thead class="text-xs text-slate-700 uppercase bg-slate-100">
                                    <tr>
                                        <th scope="col" class="px-3 py-3">Pos</th>
                                        <th scope="col" class="px-3 py-3">Equipo</th>
                                        <th scope="col" class="px-3 py-3">PJ</th>
                                        <th scope="col" class="px-3 py-3">PG</th>
                                        <th scope="col" class="px-3 py-3">PP</th>
                                        <th scope="col" class="px-3 py-3">Pts</th>
                                    </tr>
                                </thead>
                                <tbody id="standings-A"></tbody>
                            </table>
                        </div>
                    </div>

                    <div id="group-card-B" class="bg-white p-6 rounded-lg shadow-lg">
                        <h3 class="text-xl font-bold text-sky-700 mb-4">Grupo B</h3>
                        <div class="overflow-x-auto">
                           <table class="w-full text-sm text-left text-slate-500">
                                <thead class="text-xs text-slate-700 uppercase bg-slate-100">
                                    <tr>
                                        <th scope="col" class="px-3 py-3">Pos</th>
                                        <th scope="col" class="px-3 py-3">Equipo</th>
                                        <th scope="col" class="px-3 py-3">PJ</th>
                                        <th scope="col" class="px-3 py-3">PG</th>
                                        <th scope="col" class="px-3 py-3">PP</th>
                                        <th scope="col" class="px-3 py-3">Pts</th>
                                    </tr>
                                </thead>
                                <tbody id="standings-B"></tbody>
                            </table>
                        </div>
                    </div>
                    
                    <div id="group-card-C" class="bg-white p-6 rounded-lg shadow-lg">
                        <h3 class="text-xl font-bold text-sky-700 mb-4">Grupo C</h3>
                        <div class="overflow-x-auto">
                            <table class="w-full text-sm text-left text-slate-500">
                                <thead class="text-xs text-slate-700 uppercase bg-slate-100">
                                    <tr>
                                        <th scope="col" class="px-3 py-3">Pos</th>
                                        <th scope="col" class="px-3 py-3">Equipo</th>
                                        <th scope="col" class="px-3 py-3">PJ</th>
                                        <th scope="col" class="px-3 py-3">PG</th>
                                        <th scope="col" class="px-3 py-3">PP</th>
                                        <th scope="col" class="px-3 py-3">Pts</th>
                                    </tr>
                                </thead>
                                <tbody id="standings-C"></tbody>
                            </table>
                        </div>
                    </div>

                    <div id="group-card-D" class="bg-white p-6 rounded-lg shadow-lg">
                        <h3 class="text-xl font-bold text-sky-700 mb-4">Grupo D</h3>
                        <div class="overflow-x-auto">
                            <table class="w-full text-sm text-left text-slate-500">
                                <thead class="text-xs text-slate-700 uppercase bg-slate-100">
                                     <tr>
                                        <th scope="col" class="px-3 py-3">Pos</th>
                                        <th scope="col" class="px-3 py-3">Equipo</th>
                                        <th scope="col" class="px-3 py-3">PJ</th>
                                        <th scope="col" class="px-3 py-3">PG</th>
                                        <th scope="col" class="px-3 py-3">PP</th>
                                        <th scope="col" class="px-3 py-3">Pts</th>
                                    </tr>
                                </thead>
                                <tbody id="standings-D"></tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <section id="fase-grupos" class="page-section hidden">
            <div class="px-4 py-6 sm:px-0">
                <h2 class="text-3xl font-bold tracking-tight text-slate-900 mb-6">Ingresar Resultados: Fase de Grupos</h2>
                <p class="text-slate-600 mb-8 max-w-3xl">Ingresa los puntos de cada set. El partido es al mejor de 3 sets, sin alargue. Los dos primeros sets se juegan a 25 puntos y el tercero a 15 puntos.</p>
                <div class="mb-6 flex flex-wrap gap-2">
                    <button data-group="A" class="group-filter px-4 py-2 text-sm font-medium border border-slate-300 rounded-md hover:bg-sky-50 active">Grupo A</button>
                    <button data-group="B" class="group-filter px-4 py-2 text-sm font-medium border border-slate-300 rounded-md hover:bg-sky-50">Grupo B</button>
                    <button data-group="C" class="group-filter px-4 py-2 text-sm font-medium border border-slate-300 rounded-md hover:bg-sky-50">Grupo C</button>
                    <button data-group="D" class="group-filter px-4 py-2 text-sm font-medium border border-slate-300 rounded-md hover:bg-sky-50">Grupo D</button>
                </div>

                <div class="bg-white p-6 rounded-lg shadow-lg">
                    <div id="schedule-A" class="group-schedule space-y-4"></div>
                    <div id="schedule-B" class="group-schedule hidden space-y-4"></div>
                    <div id="schedule-C" class="group-schedule hidden space-y-4"></div>
                    <div id="schedule-D" class="group-schedule hidden space-y-4"></div>
                </div>
            </div>
        </section>
        
        <section id="intergrupos" class="page-section hidden">
            <div class="px-4 py-6 sm:px-0">
                <h2 class="text-3xl font-bold tracking-tight text-slate-900 mb-6">Ingresar Resultados: Partidos Intergrupos</h2>
                <p class="text-slate-600 mb-8 max-w-3xl">Ingresa los puntos de cada set. El partido es al mejor de 3 sets, sin alargue. Los dos primeros sets se juegan a 25 puntos y el tercero a 15 puntos.</p>
                <div class="bg-white p-6 rounded-lg shadow-lg">
                    <div id="schedule-intergroup" class="space-y-4"></div>
                </div>
            </div>
        </section>

        <section id="ranking-general" class="page-section hidden">
            <div class="px-4 py-6 sm:px-0">
                <h2 class="text-3xl font-bold tracking-tight text-slate-900 mb-6">Ranking General</h2>
                <p class="text-slate-600 mb-8 max-w-3xl">Esta es la tabla de posiciones general de todos los equipos del torneo, ordenada automáticamente por rendimiento. Los resultados de la fase de grupos y los partidos intergrupos se combinan para generar este ranking.</p>
                <div class="bg-white p-6 rounded-lg shadow-lg overflow-x-auto">
                    <table id="ranking-table" class="w-full text-sm text-left text-slate-500">
                         <thead class="text-xs text-slate-700 uppercase bg-slate-100">
                            <tr>
                                <th scope="col" class="px-4 py-3">Pos</th>
                                <th scope="col" class="px-4 py-3">Equipo</th>
                                <th scope="col" class="px-4 py-3">Grupo</th>
                                <th scope="col" class="px-4 py-3">PJ</th>
                                <th scope="col" class="px-4 py-3">PG</th>
                                <th scope="col" class="px-4 py-3">PP</th>
                                <th scope="col" class="px-4 py-3">Pts</th>
                            </tr>
                        </thead>
                        <tbody id="ranking-body">
                        </tbody>
                    </table>
                </div>
            </div>
        </section>

        <section id="fase-final" class="page-section hidden">
            <div class="px-4 py-6 sm:px-0">
                <h2 class="text-3xl font-bold tracking-tight text-slate-900 mb-6">Fase Final: Cuartos de Final</h2>
                <p class="text-slate-600 mb-8 max-w-3xl">Los dos mejores equipos de cada grupo avanzan a los cuartos de final, basados en el ranking general. A continuación se muestran las llaves del torneo.</p>

                <div class="bg-white p-6 rounded-lg shadow-lg mb-8">
                    <h3 class="text-xl font-bold text-sky-700 mb-4">Llaves de Cuartos de Final</h3>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4 text-sm">
                        <div class="space-y-3">
                            <h4 class="font-semibold text-slate-800 border-b pb-2 mb-2">Enfrentamientos</h4>
                            <p><span class="font-bold">Cuartos 1:</span> 1º Grupo A vs. 2º Grupo D</p>
                            <p><span class="font-bold">Cuartos 2:</span> 1º Grupo B vs. 2º Grupo C</p>
                            <p><span class="font-bold">Cuartos 3:</span> 1º Grupo C vs. 2º Grupo A</p>
                            <p><span class="font-bold">Cuartos 4:</span> 1º Grupo D vs. 2º Grupo B</p>
                        </div>
                    </div>
                </div>
                
                <div class="bg-white p-4 md:p-6 rounded-lg shadow-lg overflow-x-auto">
                    <h3 class="text-xl font-bold text-sky-700 mb-6 text-center">Llaves del Torneo</h3>
                    <div class="flex flex-col md:flex-row justify-center min-w-[800px] md:min-w-full">
                        <div class="bracket-round flex-1 px-2">
                            <h4 class="font-bold text-center mb-4">Cuartos de Final</h4>
                            <div class="bg-slate-50 bracket-item p-2 rounded mb-10 text-center text-xs"><p class="font-bold">QF 1</p><p id="qf1-team1">1º Grupo A</p><p class="font-bold">vs</p><p id="qf1-team2">2º Grupo D</p></div>
                            <div class="bg-slate-50 bracket-item p-2 rounded mb-10 text-center text-xs"><p class="font-bold">QF 2</p><p id="qf2-team1">1º Grupo B</p><p class="font-bold">vs</p><p id="qf2-team2">2º Grupo C</p></div>
                            <div class="bg-slate-50 bracket-item p-2 rounded mb-10 text-center text-xs"><p class="font-bold">QF 3</p><p id="qf3-team1">1º Grupo C</p><p class="font-bold">vs</p><p id="qf3-team2">2º Grupo A</p></div>
                            <div class="bg-slate-50 bracket-item p-2 rounded text-center text-xs"><p class="font-bold">QF 4</p><p id="qf4-team1">1º Grupo D</p><p class="font-bold">vs</p><p id="qf4-team2">2º Grupo B</p></div>
                        </div>
                        <div class="bracket-round flex-1 px-2">
                            <h4 class="font-bold text-center mb-4">Semifinales</h4>
                            <div class="bg-slate-50 bracket-item p-3 rounded h-32 flex items-center justify-center mb-24 text-center text-xs bracket-path"><div><p class="font-bold">SF 1</p><p>Ganador QF 1</p><p class="font-bold">vs</p><p>Ganador QF 2</p></div></div>
                            <div class="bg-slate-50 bracket-item p-3 rounded h-32 flex items-center justify-center text-center text-xs bracket-path"><div><p class="font-bold">SF 2</p><p>Ganador QF 3</p><p class="font-bold">vs</p><p>Ganador QF 4</p></div></div>
                        </div>
                        <div class="bracket-round flex-1 px-2">
                             <h4 class="font-bold text-center mb-4">Final</h4>
                             <div class="bg-sky-100 border-2 border-sky-300 p-4 rounded h-64 flex items-center justify-center text-center text-sm bracket-path"><div><p class="font-bold">GRAN FINAL</p><p>Ganador SF 1</p><p class="font-bold text-lg">vs</p><p>Ganador SF 2</p></div></div>
                        </div>
                    </div>
                </div>
            </div>
        </section>
    </main>

    <script>
        document.addEventListener('DOMContentLoaded', function () {
            
            const TEAMS = {
                "Top Volley":      { group: "A", pj: 0, pg: 0, pp: 0, pts: 0, sf: 0, sc: 0 },
                "DVA Green":       { group: "A", pj: 0, pg: 0, pp: 0, pts: 0, sf: 0, sc: 0 },
                "Sky´s revengers": { group: "A", pj: 0, pg: 0, pp: 0, pts: 0, sf: 0, sc: 0 },
                "Sendero":         { group: "A", pj: 0, pg: 0, pp: 0, pts: 0, sf: 0, sc: 0 },
                "Águilas":         { group: "B", pj: 0, pg: 0, pp: 0, pts: 0, sf: 0, sc: 0 },
                "LVA A":           { group: "B", pj: 0, pg: 0, pp: 0, pts: 0, sf: 0, sc: 0 },
                "Ballbreakers B":  { group: "B", pj: 0, pg: 0, pp: 0, pts: 0, sf: 0, sc: 0 },
                "DVA Yellow":      { group: "B", pj: 0, pg: 0, pp: 0, pts: 0, sf: 0, sc: 0 },
                "DVA Blue":        { group: "C", pj: 0, pg: 0, pp: 0, pts: 0, sf: 0, sc: 0 },
                "Volleytime Rio":  { group: "C", pj: 0, pg: 0, pp: 0, pts: 0, sf: 0, sc: 0 },
                "Cuervos":         { group: "C", pj: 0, pg: 0, pp: 0, pts: 0, sf: 0, sc: 0 },
                "Rider":           { group: "C", pj: 0, pg: 0, pp: 0, pts: 0, sf: 0, sc: 0 },
                "Covoley":         { group: "D", pj: 0, pg: 0, pp: 0, pts: 0, sf: 0, sc: 0 },
                "Aston Quilla":    { group: "D", pj: 0, pg: 0, pp: 0, pts: 0, sf: 0, sc: 0 },
                "Ballbreakers A":  { group: "D", pj: 0, pg: 0, pp: 0, pts: 0, sf: 0, sc: 0 },
                "Volleytime sol":  { group: "D", pj: 0, pg: 0, pp: 0, pts: 0, sf: 0, sc: 0 },
                "LVA B":           { group: "D", pj: 0, pg: 0, pp: 0, pts: 0, sf: 0, sc: 0 }
            };

            const MATCHES = [
                // Grupo A
                { jornada: 1, group: 'A', team1: 'Top Volley', team2: 'Sendero' },
                { jornada: 1, group: 'A', team1: 'DVA Green', team2: 'Sky´s revengers' },
                { jornada: 2, group: 'A', team1: 'Top Volley', team2: 'Sky´s revengers' },
                { jornada: 2, group: 'A', team1: 'DVA Green', team2: 'Sendero' },
                { jornada: 3, group: 'A', team1: 'Top Volley', team2: 'DVA Green' },
                { jornada: 3, group: 'A', team1: 'Sky´s revengers', team2: 'Sendero' },
                // Grupo B
                { jornada: 1, group: 'B', team1: 'Águilas', team2: 'DVA Yellow' },
                { jornada: 1, group: 'B', team1: 'LVA A', team2: 'Ballbreakers B' },
                { jornada: 2, group: 'B', team1: 'Águilas', team2: 'Ballbreakers B' },
                { jornada: 2, group: 'B', team1: 'LVA A', team2: 'DVA Yellow' },
                { jornada: 3, group: 'B', team1: 'Águilas', team2: 'LVA A' },
                { jornada: 3, group: 'B', team1: 'Ballbreakers B', team2: 'DVA Yellow' },
                // Grupo C
                { jornada: 1, group: 'C', team1: 'DVA Blue', team2: 'Rider' },
                { jornada: 1, group: 'C', team1: 'Volleytime Rio', team2: 'Cuervos' },
                { jornada: 2, group: 'C', team1: 'DVA Blue', team2: 'Cuervos' },
                { jornada: 2, group: 'C', team1: 'Volleytime Rio', team2: 'Rider' },
                { jornada: 3, group: 'C', team1: 'DVA Blue', team2: 'Volleytime Rio' },
                { jornada: 3, group: 'C', team1: 'Cuervos', team2: 'Rider' },
                // Grupo D
                { jornada: 1, group: 'D', team1: 'Covoley', team2: 'LVA B' },
                { jornada: 1, group: 'D', team1: 'Aston Quilla', team2: 'Volleytime sol' },
                { jornada: 2, group: 'D', team1: 'Covoley', team2: 'Volleytime sol' },
                { jornada: 2, group: 'D', team1: 'Aston Quilla', team2: 'Ballbreakers A' },
                { jornada: 3, group: 'D', team1: 'Covoley', team2: 'Aston Quilla' },
                { jornada: 3, group: 'D', team1: 'Volleytime sol', team2: 'Ballbreakers A' },
            ];

            const INTERGROUP_MATCHES = [
                { matchId: 'IG1', team1: 'Top Volley', team2: 'DVA Yellow' },
                { matchId: 'IG2', team1: 'DVA Green', team2: 'Ballbreakers B' },
                { matchId: 'IG3', team1: 'Sky´s revengers', team2: 'Volleytime Rio' },
                { matchId: 'IG4', team1: 'Sendero', team2: 'DVA Blue' },
                { matchId: 'IG5', team1: 'Águilas', team2: 'Rider' },
                { matchId: 'IG6', team1: 'LVA A', team2: 'Cuervos' },
            ];
            
            const STANDINGS = { A: [], B: [], C: [], D: [] };

            const pageSections = document.querySelectorAll('.page-section');
            const navLinks = document.querySelectorAll('.nav-link');
            const mobileNav = document.getElementById('mobile-nav');
            const groupFilters = document.querySelectorAll('.group-filter');
            const groupSchedules = document.querySelectorAll('.group-schedule');
            
            // Function to show a specific section
            const showSection = (targetId) => {
                pageSections.forEach(section => {
                    section.id === targetId.substring(1) ? section.classList.remove('hidden') : section.classList.add('hidden');
                });
                navLinks.forEach(link => link.classList.remove('active'));
                const activeLink = document.querySelector(`a[href="${targetId}"]`);
                if (activeLink) activeLink.classList.add('active');
                mobileNav.value = targetId;
            }

            // Function to render standings tables
            const renderStandings = (group, standings) => {
                const tbody = document.getElementById(`standings-${group}`);
                tbody.innerHTML = '';
                standings.forEach((team, index) => {
                    const row = document.createElement('tr');
                    row.className = 'bg-white border-b hover:bg-slate-50';
                    row.innerHTML = `
                        <td class="px-3 py-4 font-medium text-slate-900">${index + 1}</td>
                        <td class="px-3 py-4">${team.name}</td>
                        <td class="px-3 py-4">${team.pj}</td>
                        <td class="px-3 py-4">${team.pg}</td>
                        <td class="px-3 py-4">${team.pp}</td>
                        <td class="px-3 py-4">${team.pts}</td>
                    `;
                    tbody.appendChild(row);
                });
            }

            // Function to render group stage matches
            const renderSchedules = () => {
                const scheduleContainers = { A: document.getElementById('schedule-A'), B: document.getElementById('schedule-B'), C: document.getElementById('schedule-C'), D: document.getElementById('schedule-D') };
                for (const group in scheduleContainers) {
                    scheduleContainers[group].innerHTML = '';
                    const groupMatches = MATCHES.filter(m => m.group === group);
                    groupMatches.forEach((match, index) => {
                        const matchDiv = document.createElement('div');
                        matchDiv.className = 'bg-slate-50 p-4 rounded-lg shadow-sm flex flex-col sm:flex-row items-center justify-between';
                        matchDiv.innerHTML = `
                            <div class="mb-2 sm:mb-0 text-center sm:text-left flex-1">
                                <p class="text-sm font-semibold">${match.team1}</p>
                                <p class="text-xs text-slate-500">vs</p>
                                <p class="text-sm font-semibold">${match.team2}</p>
                            </div>
                            <div class="flex flex-col sm:flex-row items-center gap-2">
                                <span class="text-xs text-slate-600">Sets:</span>
                                <div class="flex space-x-2">
                                    <div class="flex flex-col items-center">
                                        <label class="text-xs text-slate-500">${match.team1}</label>
                                        <div class="flex gap-1">
                                            <input type="number" data-team="${match.team1}" data-group="${match.group}" data-match-index="${MATCHES.indexOf(match)}" data-set="1" class="score-input w-12 text-center text-sm border-2 border-slate-300 rounded-md focus:border-sky-500 focus:outline-none p-1" value="0">
                                            <input type="number" data-team="${match.team1}" data-group="${match.group}" data-match-index="${MATCHES.indexOf(match)}" data-set="2" class="score-input w-12 text-center text-sm border-2 border-slate-300 rounded-md focus:border-sky-500 focus:outline-none p-1" value="0">
                                            <input type="number" data-team="${match.team1}" data-group="${match.group}" data-match-index="${MATCHES.indexOf(match)}" data-set="3" class="score-input w-12 text-center text-sm border-2 border-slate-300 rounded-md focus:border-sky-500 focus:outline-none p-1" value="0">
                                        </div>
                                    </div>
                                    <div class="flex flex-col items-center">
                                        <label class="text-xs text-slate-500">${match.team2}</label>
                                        <div class="flex gap-1">
                                            <input type="number" data-team="${match.team2}" data-group="${match.group}" data-match-index="${MATCHES.indexOf(match)}" data-set="1" class="score-input w-12 text-center text-sm border-2 border-slate-300 rounded-md focus:border-sky-500 focus:outline-none p-1" value="0">
                                            <input type="number" data-team="${match.team2}" data-group="${match.group}" data-match-index="${MATCHES.indexOf(match)}" data-set="2" class="score-input w-12 text-center text-sm border-2 border-slate-300 rounded-md focus:border-sky-500 focus:outline-none p-1" value="0">
                                            <input type="number" data-team="${match.team2}" data-group="${match.group}" data-match-index="${MATCHES.indexOf(match)}" data-set="3" class="score-input w-12 text-center text-sm border-2 border-slate-300 rounded-md focus:border-sky-500 focus:outline-none p-1" value="0">
                                        </div>
                                    </div>
                                </div>
                            </div>
                        `;
                        scheduleContainers[group].appendChild(matchDiv);
                    });
                }
            }

            // Function to render intergroup matches
            const renderIntergroupSchedule = () => {
                const container = document.getElementById('schedule-intergroup');
                container.innerHTML = '';
                INTERGROUP_MATCHES.forEach(match => {
                    const matchDiv = document.createElement('div');
                    matchDiv.className = 'bg-slate-50 p-4 rounded-lg shadow-sm flex flex-col sm:flex-row items-center justify-between';
                    matchDiv.innerHTML = `
                        <div class="mb-2 sm:mb-0 text-center sm:text-left flex-1">
                            <p class="text-sm font-semibold">${match.team1}</p>
                            <p class="text-xs text-slate-500">vs</p>
                            <p class="text-sm font-semibold">${match.team2}</p>
                        </div>
                        <div class="flex flex-col sm:flex-row items-center gap-2">
                            <span class="text-xs text-slate-600">Sets:</span>
                            <div class="flex space-x-2">
                                <div class="flex flex-col items-center">
                                    <label class="text-xs text-slate-500">${match.team1}</label>
                                    <div class="flex gap-1">
                                        <input type="number" data-team="${match.team1}" data-match-id="${match.matchId}" data-set="1" class="score-input w-12 text-center text-sm border-2 border-slate-300 rounded-md focus:border-sky-500 focus:outline-none p-1" value="0">
                                        <input type="number" data-team="${match.team1}" data-match-id="${match.matchId}" data-set="2" class="score-input w-12 text-center text-sm border-2 border-slate-300 rounded-md focus:border-sky-500 focus:outline-none p-1" value="0">
                                        <input type="number" data-team="${match.team1}" data-match-id="${match.matchId}" data-set="3" class="score-input w-12 text-center text-sm border-2 border-slate-300 rounded-md focus:border-sky-500 focus:outline-none p-1" value="0">
                                    </div>
                                </div>
                                <div class="flex flex-col items-center">
                                    <label class="text-xs text-slate-500">${match.team2}</label>
                                    <div class="flex gap-1">
                                        <input type="number" data-team="${match.team2}" data-match-id="${match.matchId}" data-set="1" class="score-input w-12 text-center text-sm border-2 border-slate-300 rounded-md focus:border-sky-500 focus:outline-none p-1" value="0">
                                        <input type="number" data-team="${match.team2}" data-match-id="${match.matchId}" data-set="2" class="score-input w-12 text-center text-sm border-2 border-slate-300 rounded-md focus:border-sky-500 focus:outline-none p-1" value="0">
                                        <input type="number" data-team="${match.team2}" data-match-id="${match.matchId}" data-set="3" class="score-input w-12 text-center text-sm border-2 border-slate-300 rounded-md focus:border-sky-500 focus:outline-none p-1" value="0">
                                    </div>
                                </div>
                            </div>
                        </div>
                    `;
                    container.appendChild(matchDiv);
                });
            }

            // Function to save scores to localStorage
            const saveScoresToLocalStorage = () => {
                const scores = {};
                document.querySelectorAll('.score-input').forEach(input => {
                    const matchId = input.dataset.matchId || `group-${input.dataset.matchIndex}`;
                    const key = `${matchId}_${input.dataset.team}_${input.dataset.set}`;
                    scores[key] = input.value;
                });
                localStorage.setItem('volleyballScores', JSON.stringify(scores));
            };

            // Function to load scores from localStorage
            const loadScoresFromLocalStorage = () => {
                const savedScores = localStorage.getItem('volleyballScores');
                if (savedScores) {
                    const scores = JSON.parse(savedScores);
                    document.querySelectorAll('.score-input').forEach(input => {
                        const matchId = input.dataset.matchId || `group-${input.dataset.matchIndex}`;
                        const key = `${matchId}_${input.dataset.team}_${input.dataset.set}`;
                        if (scores[key] !== undefined) {
                            input.value = scores[key];
                        }
                    });
                }
            };

            // Function to calculate and update standings based on match results
            const calculateStandings = () => {
                const teamsData = JSON.parse(JSON.stringify(TEAMS));
                const teamStats = {};
                for (const team in teamsData) {
                    teamStats[team] = { ...teamsData[team] };
                }

                // Process Group Stage Matches
                MATCHES.forEach((match, index) => {
                    const inputs = document.querySelectorAll(`input[data-match-index="${index}"]`);
                    if (inputs.length < 6) return;
                    
                    const team1Inputs = Array.from(inputs).filter(i => i.dataset.team === match.team1);
                    const team2Inputs = Array.from(inputs).filter(i => i.dataset.team === match.team2);

                    let team1SetsWon = 0;
                    let team2SetsWon = 0;
                    for (let i = 0; i < 3; i++) {
                        const score1 = parseInt(team1Inputs[i].value) || 0;
                        const score2 = parseInt(team2Inputs[i].value) || 0;
                        if (score1 > score2) team1SetsWon++;
                        else if (score2 > score1) team2SetsWon++;
                    }
                    
                    if (team1SetsWon > 0 || team2SetsWon > 0) {
                        const team1 = teamStats[match.team1];
                        const team2 = teamStats[match.team2];

                        team1.pj++; team2.pj++;
                        team1.sf += team1SetsWon; team1.sc += team2SetsWon;
                        team2.sf += team2SetsWon; team2.sc += team1SetsWon;

                        if (team1SetsWon > team2SetsWon) {
                            team1.pg++; team2.pp++;
                            team1.pts += 2; team2.pts += 1;
                        } else if (team2SetsWon > team1SetsWon) {
                            team2.pg++; team1.pp++;
                            team2.pts += 2; team1.pts += 1;
                        }
                    }
                });

                // Process Intergroup Matches
                INTERGROUP_MATCHES.forEach((match) => {
                    const inputs = document.querySelectorAll(`input[data-match-id="${match.matchId}"]`);
                     if (inputs.length < 6) return;

                    const team1Inputs = Array.from(inputs).filter(i => i.dataset.team === match.team1);
                    const team2Inputs = Array.from(inputs).filter(i => i.dataset.team === match.team2);
                    
                    let team1SetsWon = 0;
                    let team2SetsWon = 0;
                    for (let i = 0; i < 3; i++) {
                        const score1 = parseInt(team1Inputs[i].value) || 0;
                        const score2 = parseInt(team2Inputs[i].value) || 0;
                        if (score1 > score2) team1SetsWon++;
                        else if (score2 > score1) team2SetsWon++;
                    }
                    
                    if (team1SetsWon > 0 || team2SetsWon > 0) {
                        const team1 = teamStats[match.team1];
                        const team2 = teamStats[match.team2];

                        team1.pj++; team2.pj++;
                        team1.sf += team1SetsWon; team1.sc += team2SetsWon;
                        team2.sf += team2SetsWon; team2.sc += team1SetsWon;

                        if (team1SetsWon > team2SetsWon) {
                            team1.pg++; team2.pp++;
                            team1.pts += 2; team2.pts += 1;
                        } else if (team2SetsWon > team1SetsWon) {
                            team2.pg++; team1.pp++;
                            team2.pts += 2; team1.pts += 1;
                        }
                    }
                });

                // Update standings for each group
                for (const group in STANDINGS) {
                    STANDINGS[group] = Object.keys(teamStats).filter(team => teamStats[team].group === group).map(name => ({ name, ...teamStats[name] }));
                    STANDINGS[group].sort((a, b) => b.pts - a.pts || b.pg - a.pg || (b.sf - b.sc) - (a.sf - a.sc));
                    renderStandings(group, STANDINGS[group]);
                }
                
                // Calculate and render general ranking
                const allTeams = Object.keys(teamStats).map(teamName => ({ name: teamName, ...teamStats[teamName] }));
                allTeams.sort((a, b) => b.pts - a.pts || b.pg - a.pg || (b.sf - b.sc) - (a.sf - a.sc));
                renderGeneralRanking(allTeams);

                // Update final bracket and save data
                updateFinalBracket();
                saveScoresToLocalStorage();
            }

            const updateFinalBracket = () => {
                const getTeam = (group, pos) => STANDINGS[group][pos] ? STANDINGS[group][pos].name : `${pos+1}º Grupo ${group}`;
            
                document.getElementById('qf1-team1').textContent = getTeam('A', 0);
                document.getElementById('qf1-team2').textContent = getTeam('D', 1);
                document.getElementById('qf2-team1').textContent = getTeam('B', 0);
                document.getElementById('qf2-team2').textContent = getTeam('C', 1);
                document.getElementById('qf3-team1').textContent = getTeam('C', 0);
                document.getElementById('qf3-team2').textContent = getTeam('A', 1);
                document.getElementById('qf4-team1').textContent = getTeam('D', 0);
                document.getElementById('qf4-team2').textContent = getTeam('B', 1);
            }

            // Function to render general ranking table
            const renderGeneralRanking = (ranking) => {
                const tbody = document.getElementById('ranking-body');
                tbody.innerHTML = '';
                ranking.forEach((team, index) => {
                    const row = document.createElement('tr');
                    row.className = 'bg-white border-b hover:bg-slate-50';
                    row.innerHTML = `
                        <td class="px-4 py-3 font-medium text-slate-900">${index + 1}</td>
                        <td class="px-4 py-3">${team.name}</td>
                        <td class="px-4 py-3">${team.group}</td>
                        <td class="px-4 py-3">${team.pj}</td>
                        <td class="px-4 py-3">${team.pg}</td>
                        <td class="px-4 py-3">${team.pp}</td>
                        <td class="px-4 py-3">${team.pts}</td>
                    `;
                    tbody.appendChild(row);
                });
            }

            // --- Initial Load ---
            const initialSection = window.location.hash || '#grupos';
            renderSchedules();
            renderIntergroupSchedule();
            loadScoresFromLocalStorage();
            
            document.querySelectorAll('.score-input').forEach(input => {
                input.addEventListener('input', calculateStandings);
            });

            calculateStandings();
            showSection(initialSection);

            navLinks.forEach(link => {
                link.addEventListener('click', (e) => {
                    e.preventDefault();
                    const targetId = link.getAttribute('href');
                    showSection(targetId);
                    window.history.pushState(null, '', targetId);
                });
            });

            mobileNav.addEventListener('change', (e) => showSection(e.target.value));
            
            groupFilters.forEach(button => {
                button.addEventListener('click', () => {
                    const targetGroup = button.dataset.group;
                    groupSchedules.forEach(s => s.id === `schedule-${targetGroup}` ? s.classList.remove('hidden') : s.classList.add('hidden'));
                    groupFilters.forEach(btn => btn.classList.remove('active'));
                    button.classList.add('active');
                });
            });
        });
        
    </script>
</body>
</html>
